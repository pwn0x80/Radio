{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useSelector } from \"react-redux\";\nimport { useEffect, useReducer, useState } from \"react\";\nconst initAudio = {\n  success: false,\n  pending: false,\n  error: false\n};\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"start\":\n      return {\n        success: false,\n        pending: true,\n        error: false\n      };\n    case \"success\":\n      return {\n        success: true,\n        pending: false,\n        error: false\n      };\n    case \"fail\":\n      return {\n        success: false,\n        pending: false,\n        error: true\n      };\n  }\n};\nfunction startPlayback(handleStart) {\n  handleStart();\n  return document.getElementById('player').play();\n}\nexport let useController = () => {\n  _s();\n  const [currentAudioStatus, dispatch] = useReducer(reducer, initAudio);\n  const [volume, setVolume] = useState(false);\n  const handleStart = () => {\n    dispatch({\n      type: \"start\"\n    });\n  };\n  const handlesuccess = () => {\n    dispatch({\n      type: \"success\"\n    });\n  };\n  const handleError = () => {\n    dispatch({\n      type: \"fail\"\n    });\n  };\n  const uuid = useSelector(state => state.radio.audio.uuid);\n  const trackName = useSelector(state => state.radio.audio.trackName);\n  const [playBtn, setPlayBtn] = useState(false);\n  useEffect(() => {\n    if (trackName == undefined) return;\n    startPlayback(handleStart).then(() => {\n      handlesuccess();\n      setPlayBtn(true);\n    }).catch(() => {\n      handleError();\n    });\n  }, [trackName]);\n  let playTrigger = e => {\n    if (trackName == undefined) {\n      alert(\"plz select song first\");\n      return;\n    }\n    let t = document.getElementById('player');\n    //  play\n    if (t.currentTime > 0 && !t.paused && !t.ended) {\n      t.pause();\n      setPlayBtn(false);\n    } else {\n      setPlayBtn(true);\n      t.play().then().catch(e => {\n        console.error(e);\n      });\n    }\n  };\n  let prevTrigger = e => {\n    let currentDataId = document.querySelector(`div[data-id='${uuid}']`);\n    currentDataId.previousSibling.click();\n  };\n  let nextTrigger = e => {\n    let currentDataId = document.querySelector(`div[data-id='${uuid}']`);\n    currentDataId.nextSibling.click();\n  };\n  let volumeMuteTrigger = () => {\n    let muteBtn = document.getElementById('player');\n    if (muteBtn.muted) {\n      //pause true\n      muteBtn.muted = false;\n      setVolume(false);\n    } else {\n      muteBtn.muted = true;\n      setVolume(true);\n    }\n  };\n  return {\n    volume,\n    volumeMuteTrigger,\n    playTrigger,\n    playBtn,\n    prevTrigger,\n    nextTrigger,\n    currentAudioStatus\n  };\n};\n_s(useController, \"04lRCEKMaigORCj58HaZNwdiQn4=\", false, function () {\n  return [useSelector, useSelector];\n});\nexport default useController;","map":{"version":3,"names":["useSelector","useEffect","useReducer","useState","initAudio","success","pending","error","reducer","state","action","type","startPlayback","handleStart","document","getElementById","play","useController","currentAudioStatus","dispatch","volume","setVolume","handlesuccess","handleError","uuid","radio","audio","trackName","playBtn","setPlayBtn","undefined","then","catch","playTrigger","e","alert","t","currentTime","paused","ended","pause","console","prevTrigger","currentDataId","querySelector","previousSibling","click","nextTrigger","nextSibling","volumeMuteTrigger","muteBtn","muted"],"sources":["/home/pwn0x80/Documents/projects/radio/src/utils/useAudioController.jsx"],"sourcesContent":["import { useSelector } from \"react-redux\"\nimport { useEffect, useReducer, useState } from \"react\"\nconst initAudio =\n{\n  success: false,\n  pending: false,\n  error: false,\n}\n\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"start\":\n      return { success: false, pending: true, error: false }\n    case \"success\":\n      return { success: true, pending: false, error: false }\n    case \"fail\":\n      return { success: false, pending: false, error: true }\n  }\n}\n\n\nfunction startPlayback(handleStart) {\n  handleStart()\n  return document.getElementById('player').play()\n}\n\n\nexport let useController = () => {\n  const [currentAudioStatus, dispatch] = useReducer(reducer, initAudio);\n  const [volume, setVolume] = useState(false)\n  const handleStart = () => {\n    dispatch({ type: \"start\" });\n  };\n  const handlesuccess = () => {\n    dispatch({ type: \"success\" });\n  };\n  const handleError = () => {\n    dispatch({ type: \"fail\" });\n  };\n\n  const uuid = useSelector(state => state.radio.audio.uuid)\n  const trackName = useSelector(state => state.radio.audio.trackName)\n  const [playBtn, setPlayBtn] = useState(false)\n  useEffect(() => {\n    if (trackName == undefined) return\n    startPlayback(handleStart).then(() => {\n      handlesuccess()\n      setPlayBtn(true)\n    }).catch(() => {\n      handleError()\n    })\n  }, [trackName])\n\n  let playTrigger = (e) => {\n    if (trackName == undefined) { alert(\"plz select song first\"); return }\n    let t = document.getElementById('player')\n    //  play\n    if (t.currentTime > 0 && !t.paused && !t.ended) {\n      t.pause()\n      setPlayBtn(false)\n    } else {\n      setPlayBtn(true);\n      t.play().then(\n      ).catch((e) => {\n        console.error(e)\n      })\n    }\n  }\n  let prevTrigger = (e) => {\n    let currentDataId = document.querySelector(`div[data-id='${uuid}']`)\n    currentDataId.previousSibling.click()\n  }\n  let nextTrigger = (e) => {\n    let currentDataId = document.querySelector(`div[data-id='${uuid}']`)\n    currentDataId.nextSibling.click()\n  }\n  let volumeMuteTrigger = () => {\n    let muteBtn = document.getElementById('player')\n    if (muteBtn.muted) {\n      //pause true\n      muteBtn.muted = false\n      setVolume(false)\n    } else {\n      muteBtn.muted = true\n      setVolume(true)\n    }\n  }\n  return { volume, volumeMuteTrigger, playTrigger, playBtn, prevTrigger, nextTrigger, currentAudioStatus }\n}\n\nexport default useController;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}